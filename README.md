# .NET-Authentication
A Visual Basic .NET (VB.NET) implementation that generates salts and hashes used to encrypt passwords.

## Add to project
The [Authentication.vb](Authentication.vb) code file is uncompiled. Follow these instructions to add the file to your project:

 1. Project > Add Existing Item (shift + alt + a)
 2. Select the file in the browse dialog
 3. Click Add

## Methods
### CombineSaltAndHash
Prepends the salt generated by GenerateSalt to the hash generated by GenerateHash

``` vb
Public Shared Function CombineSaltAndHash(salt As Byte(), hash As Byte()) As Byte()
```

#### Parameters
`salt` [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
The salt generated by GenerateSalt

`hash` [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
The hash generated by GenerateHash

#### Returns
[Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
A [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array with the salt prepended to the hash

#### Example
The following example illustrates the CombineSaltAndHash method:
``` vb
Dim password = "password12345"
Dim salt = Authentication.GenerateSalt()
Dim hash = Authentication.GenerateHash(password, salt)
Dim combinedHash = Authentication.CombineSaltAndHash(salt, hash)
```

### GenerateHash
Uses [Rfc2898DeriveBytes](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rfc2898derivebytes) to generate a hash

``` vb
Public Shared Function GenerateHash(password As String, salt As Byte()) As Byte()
```

#### Parameters
`password` [String](https://docs.microsoft.com/en-us/dotnet/api/system.string)
The password to hash

`salt` [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
The salt generated by GenerateSalt

#### Returns
[Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
A [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array representing the hashed password

#### Example
The following example illustrates the GenerateHash method:
``` vb
Dim password = "password12345"
Dim hash = Authentication.GenerateHash(password, salt)
```

#### Remarks
While the salt can theoretically take in any [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array, it is recommended that you pass in values generated by GenerateSalt

### GenerateSalt
Uses [RNGCryptoServiceProvider](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.RNGCryptoServiceProvider) to generate a salt

``` vb
Public Shared Function GenerateSalt() As Byte()
```

#### Returns
[Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array
A [Byte](https://docs.microsoft.com/en-us/dotnet/api/system.byte) array representing the salt

#### Example
The following example illustrates the GenerateHash method:
``` vb
Dim salt = Authentication.GenerateSalt()
```

### IsPasswordValid
Compares if an encrypted password generated by CombineSaltAndHash matches a plain text password

``` vb
Public Shared Function IsPasswordValid(encryptedPassword As String, password As String) As Boolean
```

#### Parameters
`encryptedPassword` [String](https://docs.microsoft.com/en-us/dotnet/api/system.string)
The encrypted password generated by CombineSaltAndHash and converted to a String using [Convert.ToBase64String](https://docs.microsoft.com/en-us/dotnet/api/system.convert.tobase64string)

`password` [String](https://docs.microsoft.com/en-us/dotnet/api/system.string)
The password to check

#### Returns
[Boolean](https://docs.microsoft.com/en-us/dotnet/api/system.boolean)
A [Boolean](https://docs.microsoft.com/en-us/dotnet/api/system.boolean) representing if the password matches the encrypted password

#### Example
The following example illustrates the GenerateHash method:
``` vb
Dim password = "password12345"
Dim newPassword = "password123456"
Dim salt = Authentication.GenerateSalt()
Dim hash = Authentication.GenerateHash(password, salt)
Dim combinedHash = Authentication.CombineSaltAndHash(salt, hash)
Dim encryptedPassword = Convert.ToBase64String(combinedHash)
Dim passesLogin = Authentication.IsPasswordValid(encryptedPassword, newPassword)
```
